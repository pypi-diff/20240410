# Comparing `tmp/keelson-0.3.0rc9-py3-none-any.whl.zip` & `tmp/keelson-0.3.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,35 +1,35 @@
-Zip file size: 25740 bytes, number of entries: 33
--rw-r--r--  2.0 unx     1236 b- defN 24-Apr-05 12:29 keelson/Envelope_pb2.py
--rw-r--r--  2.0 unx     3669 b- defN 24-Apr-05 12:28 keelson/__init__.py
--rw-r--r--  2.0 unx     2000 b- defN 24-Apr-05 12:28 keelson/codec.py
--rw-r--r--  2.0 unx      808 b- defN 24-Apr-05 12:29 keelson/subjects.yaml
--rw-r--r--  2.0 unx     1355 b- defN 24-Apr-05 12:29 keelson/payloads/CompressedImage_pb2.py
--rw-r--r--  2.0 unx     1355 b- defN 24-Apr-05 12:29 keelson/payloads/CompressedVideo_pb2.py
--rw-r--r--  2.0 unx     1590 b- defN 24-Apr-05 12:29 keelson/payloads/FrameTransform_pb2.py
--rw-r--r--  2.0 unx     1196 b- defN 24-Apr-05 12:29 keelson/payloads/FrameTransforms_pb2.py
--rw-r--r--  2.0 unx     1771 b- defN 24-Apr-05 12:29 keelson/payloads/ImuReading_pb2.py
--rw-r--r--  2.0 unx     1513 b- defN 24-Apr-05 12:29 keelson/payloads/LaserScan_pb2.py
--rw-r--r--  2.0 unx     1832 b- defN 24-Apr-05 12:29 keelson/payloads/LocationFix_pb2.py
--rw-r--r--  2.0 unx     1652 b- defN 24-Apr-05 12:29 keelson/payloads/Log_pb2.py
--rw-r--r--  2.0 unx     1615 b- defN 24-Apr-05 12:29 keelson/payloads/PackedElementField_pb2.py
--rw-r--r--  2.0 unx     1613 b- defN 24-Apr-05 12:29 keelson/payloads/PointCloud_pb2.py
--rw-r--r--  2.0 unx     1354 b- defN 24-Apr-05 12:29 keelson/payloads/PoseInFrame_pb2.py
--rw-r--r--  2.0 unx     1229 b- defN 24-Apr-05 12:29 keelson/payloads/Pose_pb2.py
--rw-r--r--  2.0 unx     1361 b- defN 24-Apr-05 12:29 keelson/payloads/PosesInFrame_pb2.py
--rw-r--r--  2.0 unx     1128 b- defN 24-Apr-05 12:29 keelson/payloads/Quaternion_pb2.py
--rw-r--r--  2.0 unx     1836 b- defN 24-Apr-05 12:29 keelson/payloads/RadarReading_pb2.py
--rw-r--r--  2.0 unx     1428 b- defN 24-Apr-05 12:29 keelson/payloads/RawImage_pb2.py
--rw-r--r--  2.0 unx     1278 b- defN 24-Apr-05 12:29 keelson/payloads/TimestampedBytes_pb2.py
--rw-r--r--  2.0 unx     1284 b- defN 24-Apr-05 12:29 keelson/payloads/TimestampedDouble_pb2.py
--rw-r--r--  2.0 unx     1278 b- defN 24-Apr-05 12:29 keelson/payloads/TimestampedFloat_pb2.py
--rw-r--r--  2.0 unx     1353 b- defN 24-Apr-05 12:29 keelson/payloads/TimestampedKeyValuePair_pb2.py
--rw-r--r--  2.0 unx     1279 b- defN 24-Apr-05 12:29 keelson/payloads/TimestampedString_pb2.py
--rw-r--r--  2.0 unx     1051 b- defN 24-Apr-05 12:29 keelson/payloads/Vector2_pb2.py
--rw-r--r--  2.0 unx     1079 b- defN 24-Apr-05 12:29 keelson/payloads/Vector3_pb2.py
--rw-r--r--  2.0 unx     6236 b- defN 24-Apr-05 12:29 keelson/payloads/protobuf_file_descriptor_set.bin
--rw-r--r--  2.0 unx     1357 b- defN 24-Apr-05 12:29 keelson-0.3.0rc9.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-05 12:29 keelson-0.3.0rc9.dist-info/WHEEL
--rw-r--r--  2.0 unx      413 b- defN 24-Apr-05 12:29 keelson-0.3.0rc9.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        8 b- defN 24-Apr-05 12:29 keelson-0.3.0rc9.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2963 b- defN 24-Apr-05 12:29 keelson-0.3.0rc9.dist-info/RECORD
-33 files, 51212 bytes uncompressed, 20924 bytes compressed:  59.1%
+Zip file size: 25757 bytes, number of entries: 33
+-rw-r--r--  2.0 unx     1236 b- defN 24-Apr-10 20:12 keelson/Envelope_pb2.py
+-rw-r--r--  2.0 unx     3669 b- defN 24-Apr-10 20:12 keelson/__init__.py
+-rw-r--r--  2.0 unx     3342 b- defN 24-Apr-10 20:12 keelson/codec.py
+-rw-r--r--  2.0 unx      861 b- defN 24-Apr-10 20:12 keelson/subjects.yaml
+-rw-r--r--  2.0 unx     1355 b- defN 24-Apr-10 20:12 keelson/payloads/CompressedImage_pb2.py
+-rw-r--r--  2.0 unx     1355 b- defN 24-Apr-10 20:12 keelson/payloads/CompressedVideo_pb2.py
+-rw-r--r--  2.0 unx     1590 b- defN 24-Apr-10 20:12 keelson/payloads/FrameTransform_pb2.py
+-rw-r--r--  2.0 unx     1196 b- defN 24-Apr-10 20:12 keelson/payloads/FrameTransforms_pb2.py
+-rw-r--r--  2.0 unx     1771 b- defN 24-Apr-10 20:12 keelson/payloads/ImuReading_pb2.py
+-rw-r--r--  2.0 unx     1513 b- defN 24-Apr-10 20:12 keelson/payloads/LaserScan_pb2.py
+-rw-r--r--  2.0 unx     1832 b- defN 24-Apr-10 20:12 keelson/payloads/LocationFix_pb2.py
+-rw-r--r--  2.0 unx     1652 b- defN 24-Apr-10 20:12 keelson/payloads/Log_pb2.py
+-rw-r--r--  2.0 unx     1615 b- defN 24-Apr-10 20:12 keelson/payloads/PackedElementField_pb2.py
+-rw-r--r--  2.0 unx     1613 b- defN 24-Apr-10 20:12 keelson/payloads/PointCloud_pb2.py
+-rw-r--r--  2.0 unx     1354 b- defN 24-Apr-10 20:12 keelson/payloads/PoseInFrame_pb2.py
+-rw-r--r--  2.0 unx     1229 b- defN 24-Apr-10 20:12 keelson/payloads/Pose_pb2.py
+-rw-r--r--  2.0 unx     1361 b- defN 24-Apr-10 20:12 keelson/payloads/PosesInFrame_pb2.py
+-rw-r--r--  2.0 unx     1128 b- defN 24-Apr-10 20:12 keelson/payloads/Quaternion_pb2.py
+-rw-r--r--  2.0 unx     1836 b- defN 24-Apr-10 20:12 keelson/payloads/RadarReading_pb2.py
+-rw-r--r--  2.0 unx     1428 b- defN 24-Apr-10 20:12 keelson/payloads/RawImage_pb2.py
+-rw-r--r--  2.0 unx     1278 b- defN 24-Apr-10 20:12 keelson/payloads/TimestampedBytes_pb2.py
+-rw-r--r--  2.0 unx     1284 b- defN 24-Apr-10 20:12 keelson/payloads/TimestampedDouble_pb2.py
+-rw-r--r--  2.0 unx     1278 b- defN 24-Apr-10 20:12 keelson/payloads/TimestampedFloat_pb2.py
+-rw-r--r--  2.0 unx     1353 b- defN 24-Apr-10 20:12 keelson/payloads/TimestampedKeyValuePair_pb2.py
+-rw-r--r--  2.0 unx     1279 b- defN 24-Apr-10 20:12 keelson/payloads/TimestampedString_pb2.py
+-rw-r--r--  2.0 unx     1051 b- defN 24-Apr-10 20:12 keelson/payloads/Vector2_pb2.py
+-rw-r--r--  2.0 unx     1079 b- defN 24-Apr-10 20:12 keelson/payloads/Vector3_pb2.py
+-rw-r--r--  2.0 unx     6236 b- defN 24-Apr-10 20:12 keelson/payloads/protobuf_file_descriptor_set.bin
+-rw-r--r--  2.0 unx     1078 b- defN 24-Apr-10 20:12 keelson-0.3.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-Apr-10 20:12 keelson-0.3.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx      413 b- defN 24-Apr-10 20:12 keelson-0.3.1.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        8 b- defN 24-Apr-10 20:12 keelson-0.3.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2948 b- defN 24-Apr-10 20:12 keelson-0.3.1.dist-info/RECORD
+33 files, 52313 bytes uncompressed, 20971 bytes compressed:  59.9%
```

## zipnote {}

```diff
@@ -78,23 +78,23 @@
 
 Filename: keelson/payloads/Vector3_pb2.py
 Comment: 
 
 Filename: keelson/payloads/protobuf_file_descriptor_set.bin
 Comment: 
 
-Filename: keelson-0.3.0rc9.dist-info/METADATA
+Filename: keelson-0.3.1.dist-info/METADATA
 Comment: 
 
-Filename: keelson-0.3.0rc9.dist-info/WHEEL
+Filename: keelson-0.3.1.dist-info/WHEEL
 Comment: 
 
-Filename: keelson-0.3.0rc9.dist-info/entry_points.txt
+Filename: keelson-0.3.1.dist-info/entry_points.txt
 Comment: 
 
-Filename: keelson-0.3.0rc9.dist-info/top_level.txt
+Filename: keelson-0.3.1.dist-info/top_level.txt
 Comment: 
 
-Filename: keelson-0.3.0rc9.dist-info/RECORD
+Filename: keelson-0.3.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## keelson/codec.py

```diff
@@ -1,36 +1,57 @@
-import sys
 import json
+import time
 import logging
-import warnings
-import argparse
 from base64 import b64encode, b64decode
 
-import parse
 from google.protobuf.json_format import ParseDict, MessageToDict
 
 from . import (
     enclose,
     uncover,
     is_subject_well_known,
     get_subject_from_pub_sub_key,
     get_subject_schema,
     decode_protobuf_payload_from_type_name,
     get_protobuf_message_class_from_type_name,
 )
 
+from .payloads.TimestampedBytes_pb2 import TimestampedBytes
+
 logger = logging.getLogger(__file__)
 
 
 def enclose_from_text(key: str, value: str) -> bytes:
-    return enclose(value.encode())
+    subject = get_subject_from_pub_sub_key(key)
+
+    if subject != "raw":
+        raise ValueError(
+            f"keelson-enclose-from-text can only be used together with a 'raw' subject! You tried to use it with '{subject}'"
+        )
+
+    payload = TimestampedBytes()
+    payload.timestamp.FromNanoseconds(time.time_ns())
+    payload.value = value.encode()
+
+    return enclose(payload.SerializeToString())
 
 
 def enclose_from_base64(key: str, value: str) -> bytes:
-    return enclose(b64decode(value.encode()))
+    subject = get_subject_from_pub_sub_key(key)
+
+    if subject != "raw":
+        raise ValueError(
+            f"keelson-enclose-from-base64 can only be used together with a 'raw' subject! You tried to use it with '{subject}'"
+        )
+
+    payload = TimestampedBytes()
+    payload.timestamp.FromNanoseconds(time.time_ns())
+    payload.value = b64decode(value.encode())
+
+    return enclose(payload.SerializeToString())
 
 
 def enclose_from_json(key: str, value: str) -> bytes:
     subject = get_subject_from_pub_sub_key(key)
 
     if not is_subject_well_known(subject):
         raise RuntimeError(f"Tag ({subject}) is not well-known!")
@@ -39,33 +60,47 @@
     message = get_protobuf_message_class_from_type_name(type_name)()
     pb2js = json.loads(value)
     payload = ParseDict(pb2js, message)
     return enclose(payload.SerializeToString())
 
 
 def uncover_to_text(key: str, value: bytes) -> str:
+    subject = get_subject_from_pub_sub_key(str(key))
+
+    if subject != "raw":
+        raise ValueError(
+            f"keelson-uncover-to-text can only be used together with a 'raw' subject! You tried to use it with '{subject}'"
+        )
+
     received_at, enclosed_at, payload = uncover(value)
-    return payload.decode()
+    parsed = TimestampedBytes.FromString(payload)
+    return parsed.value.decode()
 
 
 def uncover_to_base64(key: str, value: bytes) -> str:
-    received_at, enclosed_at, payload = uncover(value)
-    return b64encode(payload).decode()
+    subject = get_subject_from_pub_sub_key(str(key))
 
+    if subject != "raw":
+        raise ValueError(
+            f"keelson-uncover-to-base64 can only be used together with a 'raw' subject! You tried to use it with '{subject}'"
+        )
 
-def uncover_to_json(key: str, value: bytes) -> str:
-    key = str(key)
     received_at, enclosed_at, payload = uncover(value)
+    parsed = TimestampedBytes.FromString(payload)
+    return b64encode(parsed.value).decode()
 
-    subject = get_subject_from_pub_sub_key(key)
+
+def uncover_to_json(key: str, value: bytes) -> str:
+    subject = get_subject_from_pub_sub_key(str(key))
 
     if not is_subject_well_known(subject):
         raise RuntimeError(f"Tag ({subject}) is not well-known!")
 
     type_name = get_subject_schema(subject)
+    received_at, enclosed_at, payload = uncover(value)
     message = decode_protobuf_payload_from_type_name(payload, type_name)
     return json.dumps(
         MessageToDict(
             message,
             including_default_value_fields=True,
             preserving_proto_field_name=True,
             use_integers_for_enums=True,
```

## keelson/subjects.yaml

```diff
@@ -31,14 +31,16 @@
     schema: foxglove.CompressedImage
 
 ## Radar and Lidar
 laser_scan:
     schema: foxglove.LaserScan
 radar_spoke:
     schema: keelson.compound.RadarSpoke
+radar_sweep:
+    schema: keelson.compound.RadarSweep
 point_cloud:
     schema: foxglove.PointCloud
 
 ## Inertial Meaurement Units (IMU)
 imu_reading:
     schema: keelson.compound.ImuReading
```

## Comparing `keelson-0.3.0rc9.dist-info/RECORD` & `keelson-0.3.1.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 keelson/Envelope_pb2.py,sha256=_wvbnhRzFMR8svuPJPaWjBajaMU_gk0ozwXX0HlYgn0,1236
 keelson/__init__.py,sha256=0pWs0DZtNqiXjPRj6DcL71X8o4BrWKDXYeU4Wo6Vd2Y,3669
-keelson/codec.py,sha256=FWYxf2bmBt32_IMlEi1VEN6vVgKoX02L7u8BHdyvPJI,2000
-keelson/subjects.yaml,sha256=JrDBhbo3DfhrZJh7-A7dvZ_pnWS661gNOvldVvSsLGw,808
+keelson/codec.py,sha256=672GKPNY6BUlmNetvYqIMuIB1T2zPU4hwoqxrFwIfcU,3342
+keelson/subjects.yaml,sha256=WQfdJBB73l3vXpOUwVyUy37zYhYnWcDBu2Fdc_7XNHw,861
 keelson/payloads/CompressedImage_pb2.py,sha256=CT1LmxP5EVLXLB8L3vNUdkBka4kbwEQtdtoOFHTLzbE,1355
 keelson/payloads/CompressedVideo_pb2.py,sha256=XfGPAXLyc7BEEvpif2sMjxLeAhd4qxQizfICxnegucM,1355
 keelson/payloads/FrameTransform_pb2.py,sha256=gBggaASe6VI6jveXl96CJZ0_LdRoqjxwUiVKi0u2sjo,1590
 keelson/payloads/FrameTransforms_pb2.py,sha256=3cicWXxjEHxlXty8uxrFFwr2m-60N5IhrrIBLmB9BLI,1196
 keelson/payloads/ImuReading_pb2.py,sha256=5v_d9oykLUi0qtgNHeGVhGZD4jWvzHHjIdhyTVQnw30,1771
 keelson/payloads/LaserScan_pb2.py,sha256=fIf5PYKbNJbAyqJuOR-JxPo8XavkguAyiqGVNTyw2HA,1513
 keelson/payloads/LocationFix_pb2.py,sha256=GC4NffLPmb5tUkgzxSOEZAwzFvyMOeQEQwvaeBk0ap0,1832
@@ -22,12 +22,12 @@
 keelson/payloads/TimestampedDouble_pb2.py,sha256=KMXgMMi4S1h5w0RGFxlviHGKjLFcYf_v0wJ_fsRi6aA,1284
 keelson/payloads/TimestampedFloat_pb2.py,sha256=0atZ94JBUcHzlq991D-NZp1gG-jg1KR4ww0lq4umXIs,1278
 keelson/payloads/TimestampedKeyValuePair_pb2.py,sha256=W3Qz1RcCar39c34ThuCqWPPoU7yHcFiwNv2qSntLG3Y,1353
 keelson/payloads/TimestampedString_pb2.py,sha256=SEmr1Dg6helGG-WA1cdl8TZ5DeKW-sFvVXk3dCESpsA,1279
 keelson/payloads/Vector2_pb2.py,sha256=BNPA91XotdBc1jiWO3sz7SXSVsFC46VUegIihBdtcFg,1051
 keelson/payloads/Vector3_pb2.py,sha256=gsyH2VPiO9C3L5IX1jA3ldCGAa_FaNSfGxe8QDss4Go,1079
 keelson/payloads/protobuf_file_descriptor_set.bin,sha256=Lkq5nsVH6o3X30zRYM2sVM7i8ud0AVWCjaur1PuIYc0,6236
-keelson-0.3.0rc9.dist-info/METADATA,sha256=vA_nCO3aFFk1AYUvbO9ISOaogy-n1dmIV8Bklxg-n3s,1357
-keelson-0.3.0rc9.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-keelson-0.3.0rc9.dist-info/entry_points.txt,sha256=z4aYRNbxLKR5mrB0dmitpun0XIKBPr_4ZY5wm69UQfA,413
-keelson-0.3.0rc9.dist-info/top_level.txt,sha256=CyBwGPhq3oBgFE9cp0fPTr9udD3jEM2NcHzx4K_0Z88,8
-keelson-0.3.0rc9.dist-info/RECORD,,
+keelson-0.3.1.dist-info/METADATA,sha256=EPkQUYE6xBiL938d3UGXsXRnrSwfQP1Ovxqrsq5qJKs,1078
+keelson-0.3.1.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+keelson-0.3.1.dist-info/entry_points.txt,sha256=zjUw7zUIUDruhRSSJGkA6jjvja2kMj07DKyARa9qn4I,413
+keelson-0.3.1.dist-info/top_level.txt,sha256=CyBwGPhq3oBgFE9cp0fPTr9udD3jEM2NcHzx4K_0Z88,8
+keelson-0.3.1.dist-info/RECORD,,
```

